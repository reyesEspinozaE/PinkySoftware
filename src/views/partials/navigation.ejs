<!DOCTYPE html>
<html lang="en">

<body>
  <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
    <div class="container">
      <a class="navbar-brand" href="/index" id="index">
        <img src="img/LogoNav.jpg" alt="Logo" style="height: 30px; margin-right: 10px;">
        Pinky Software
      </a>
      <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="collapse"
        data-bs-target="#collapsibleNavId" aria-controls="collapsibleNavId" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="collapsibleNavId">
        <ul class="navbar-nav me-auto mt-2 mt-lg-0">
          <li class="nav-item">
            <a class="nav-link" id="contadurias" href="/contadurias">Contaduria</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="proyectos" href="/proyectos">Proyectos</a>
          </li>
          <li class="nav-item d-none" id="usersNav">
            <a class="nav-link" href="/users">Usuarios</a>
          </li>
          <li class="nav-item d-none" id="partidasNav">
            <a class="nav-link" href="/partidas">Partidas</a>
          </li>
        </ul>
        <ul class="navbar-nav ms-auto me-0">
          <li class="nav-item">
            <span class="nav-link">Hola, <span id="nombreUsuario">Invitado</span></span>
          </li>
          <li class="nav-item" id="loginLink">
            <a class="nav-link" href="/">Iniciar sesión</a>
          </li>
          <li class="nav-item d-none" id="logoutLink">
            <a href="/" class="nav-link" id="logoutButton">Cerrar sesión</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <script>
    // document.addEventListener('DOMContentLoaded', function () {
    //   //'/navigation'
    //   const nombreUsuario = localStorage.getItem('nombreUsuario');
    //   //const emailUsuario = localStorage.getItem('email');
    //   const rolUsuario = localStorage.getItem('rolUsuario');
    //   const isLoggedIn = localStorage.getItem('isLoggedIn');
    //   const isGuest = localStorage.getItem('isGuest');

    //   if (nombreUsuario) {
    //     document.getElementById('nombreUsuario').textContent = nombreUsuario;
    //   }

    //   if (isLoggedIn === 'true') { // Si esta logueado
    //     if (rolUsuario === 'admin' || rolUsuario === 'Admin') { // Si es un admin
    //       document.getElementById('loginLink').classList.add('d-none');
    //       document.getElementById('logoutLink').classList.remove('d-none');
    //       document.getElementById('partidasNav').classList.remove('d-none');
    //       document.getElementById('usersNav').classList.remove('d-none');
    //     } else { // Si es un user comun
    //       document.getElementById('partidasNav').classList.remove('d-none');
    //       document.getElementById('loginLink').classList.add('d-none');
    //       document.getElementById('logoutLink').classList.remove('d-none');
    //       document.getElementById('usersNav').classList.add('d-none');
    //     }
    //   } else if (isGuest === 'true') { // Si se ingresa como invitado
    //     document.getElementById('loginLink').classList.remove('d-none');
    //     document.getElementById('logoutLink').classList.add('d-none');
    //     document.getElementById('contadurias').classList.add('d-none');
    //     document.getElementById('proyectos').classList.add('d-none');
    //     document.getElementById('usersNav').classList.add('d-none');
    //     //window.location.href = '/'; // Redirigir a la página de inicio de sesión
    //   } else {
    //     document.getElementById('proyectos').classList.add('d-none');
    //     document.getElementById('partidasNav').classList.add('d-none');
    //     document.getElementById('usersNav').classList.add('d-none');
    //     document.getElementById('contadurias').classList.add('d-none');
    //     document.getElementById('proyectos').classList.add('d-none');
    //     document.getElementById('index').classList.remove('d-none');
    //     window.location.href = '/'; // Redirigir a la página de inicio de sesión
    //   }

    //   document.getElementById('logoutButton').addEventListener('click', function () {
    //     localStorage.removeItem('nombreUsuario');
    //     localStorage.removeItem('isLoggedIn');
    //     localStorage.removeItem('isGuest');
    //     //window.location.href = '/'; // Redirigir a la página de inicio de sesión
    //   });

    //   document.getElementById('loginLink').addEventListener('click', function () {
    //     localStorage.removeItem('nombreUsuario');
    //     localStorage.removeItem('isLoggedIn');
    //     localStorage.removeItem('isGuest');
    //   });
    // });

    document.addEventListener('DOMContentLoaded', function () {
      const nombreUsuario = localStorage.getItem('nombreUsuario');
      const rolUsuario = localStorage.getItem('rolUsuario');
      const isLoggedIn = localStorage.getItem('isLoggedIn');
      const isGuest = localStorage.getItem('isGuest');

      if (nombreUsuario) {
        document.getElementById('nombreUsuario').textContent = nombreUsuario;
      }

      if (isLoggedIn === 'true') {
        if (rolUsuario === 'admin' || rolUsuario === 'Admin') {
          document.getElementById('loginLink').classList.add('d-none');
          document.getElementById('logoutLink').classList.remove('d-none');
          document.getElementById('partidasNav').classList.remove('d-none');
          document.getElementById('usersNav').classList.remove('d-none');
        } else {
          document.getElementById('partidasNav').classList.remove('d-none');
          document.getElementById('loginLink').classList.add('d-none');
          document.getElementById('logoutLink').classList.remove('d-none');
          document.getElementById('usersNav').classList.add('d-none');
        }
      } else if (isGuest === 'true') {
        document.getElementById('loginLink').classList.remove('d-none');
        document.getElementById('logoutLink').classList.add('d-none');
        document.getElementById('contadurias').classList.add('d-none');
        document.getElementById('proyectos').classList.add('d-none');
        document.getElementById('partidasNav').classList.add('d-none');
        document.getElementById('usersNav').classList.add('d-none');
      }
    });

  </script>

</body>

</html>